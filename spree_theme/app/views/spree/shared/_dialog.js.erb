<% dialog = @theme.find_section_by_usage( 'dialog' ) %>
<% if dialog
  dialog_content_selector = dialog.css_selector + " .dialog_content"
  target_view ||= params[:action]
  target_view =  'edit' if ( params[:action]=='update' )
  target_view =  'new' if ( params[:action]=='create' )
%>

$("<%== dialog_content_selector %>").html(<%== ( render :partial => target_view,:formats=>[:html] ).to_json %>)
// append dialog into page-inner, apply global css on dialog.
// global css a apply close button of dialog, it cause wrong size of dialog, show disable 'close'
$("<%== dialog.css_selector %>").simplemodal({appendTo:'#page-inner',closeHTML:'', escClose:true, overlayClose:true});

<% end %>
